# 磁贴功能说明

## 概述
磁贴（Quick Settings Tile）是Android系统快速设置面板中的快捷开关，ImageOverlay应用提供了磁贴功能来快速控制遮罩的开关。

## 功能特性

### 点击切换遮罩
- **点击磁贴**：快速开启/关闭遮罩
- 如果遮罩已开启，点击会关闭遮罩
- 如果遮罩已关闭，点击会开启遮罩（需要先设置默认配置）

## 使用方法

### 添加磁贴到快速设置面板
1. 下拉通知栏，展开快速设置面板
2. 点击编辑按钮（铅笔图标）
3. 找到"默认遮罩"磁贴
4. 拖拽到快速设置面板中
5. 点击完成保存

### 使用磁贴功能
1. **快速开关**：点击磁贴快速开启/关闭遮罩

## 透明度设置

透明度调整功能已移至应用的**设置页面**中，具体位置：
- 打开应用 → 设置标签页 → 全局遮罩透明度
- 使用滑块调整透明度（0-100%）
- 支持防抖处理：调整停止500毫秒后自动保存
- **全局生效**：所有遮罩（包括新启动和正在运行的）都会使用此设置
- **实时生效**：如果遮罩正在运行，透明度调整会立即生效

## 技术实现

### 磁贴服务
- 服务类：`DefaultToggleTileService`
- 继承自：`TileService`
- 权限：`android.permission.BIND_QUICK_SETTINGS_TILE`

### 透明度控制
- 透明度值：0-100整数
- 存储方式：SharedPreferences
- 实时更新：通过ImageView的alpha属性实现

## 注意事项

1. **权限要求**：使用遮罩功能需要"显示在其他应用上层"权限
2. **默认配置**：首次使用需要先在应用中设置默认遮罩配置
3. **透明度设置**：在设置页面中调整，会应用到所有新启动的遮罩
4. **设置保存**：所有设置更改都会自动保存到本地存储

## 故障排除

### 磁贴不显示
- 检查是否已添加到快速设置面板
- 确认应用已授予必要权限

### 透明度调整
- 在应用设置页面中调整透明度
- 透明度值必须在0-100之间
- 支持防抖处理，避免频繁调整时的重复保存
- 调整停止500毫秒后自动保存
- 全局生效：所有遮罩都会使用此设置
- 实时生效：正在运行的遮罩会立即应用新的透明度设置

## 更新日志

### v2.0.0
- 简化磁贴功能，只保留开关遮罩
- 透明度设置移至设置页面，成为全局设置
- 添加防抖处理，避免频繁调整时的重复保存
- 移除Toast提示，优化用户体验
- 透明度调整支持实时生效，正在运行的遮罩会立即应用新设置
- 全局生效：所有遮罩都会使用统一的透明度设置
